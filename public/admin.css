:root {
  --bg-gradient: radial-gradient(ellipse at 50% 100%, #041a07, #000000);
  --bg-color: #000000;
  --text-color: #ffffff;
  --text-color-muted: #b0b0b0;
  --primary-color: #34c759;
  --action-color: #007aff;
  --surface-glass-bg: rgba(28, 28, 30, 0.75);
  --divider-glass-color: rgba(58, 58, 60, 0.6);
  --danger-color: #ff3b30;
  --warning-color: #ff9500;
  --status-active-color: #32d74b;
  --status-inactive-color: #98989d;
  --status-approved-color: #5856d6;
  --twitch-color: #9146FF;
}
body { margin: 0; min-height: 100vh; background-color: var(--bg-color); background-image: var(--bg-gradient); color: var(--text-color); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
.main-content { padding: 25px 20px; }
.hidden { display: none !important; }
.quests-container { display: flex; flex-direction: column; gap: 15px; }
.quest-card { background-color: var(--surface-glass-bg); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border-radius: 12px; padding: 15px; display: flex; flex-direction: column; }
.quest-title { font-size: 16px; font-weight: 600; line-height: 1.3; margin: 0 0 8px 0; flex-grow: 1; }
.page-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
.page-header-title { margin: 0; font-size: 22px; font-weight: 700; text-align: center; flex-grow: 1; }
.back-button { background: none; border: none; color: var(--action-color); font-size: 16px; cursor: pointer; padding: 5px; font-weight: 500; text-decoration: none; }
.admin-form { display: flex; flex-direction: column; gap: 15px; text-align: left; }
.admin-form input, .admin-form textarea, .admin-form select { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #555; background-color: #333; color: white; font-size: 16px; box-sizing: border-box; }
.admin-form label { font-weight: 600; font-size: 14px; margin-top: 5px; display: flex; align-items: center; gap: 6px; }
.admin-form button { background-color: var(--primary-color); border: none; padding: 12px; border-radius: 10px; color: white; font-size: 16px; font-weight: 600; cursor: pointer; }
.admin-menu-button { background-color: var(--action-color); width: 100%; border: none; padding: 12px; border-radius: 10px; color: white; font-size: 16px; font-weight: 600; cursor: pointer; }
.admin-submission-card { text-align: left; gap: 8px; }
.submission-user strong { color: var(--primary-color); }
.submission-data { background-color: rgba(0,0,0,0.4); padding: 10px; border-radius: 6px; word-break: break-all; font-family: monospace; font-size: 14px; flex-grow: 1; }
.submission-wrapper { display: flex; gap: 10px; align-items: center; margin-top: 8px; }
.action-link-btn { background-color: #5856d6; padding: 8px 12px; font-size: 12px; border-radius: 6px; color: white; text-decoration: none; font-weight: 600; flex-shrink: 0; text-align: center; }
.submission-actions { display: flex; gap: 10px; margin-top: 15px; }
.admin-action-btn { flex-grow: 1; border: none; padding: 10px; border-radius: 8px; color: white; font-size: 14px; font-weight: 600; cursor: pointer; }
.admin-action-btn.approve { background-color: var(--primary-color); }
.admin-action-btn.reject { background-color: var(--danger-color); }
.admin-action-btn.confirm { background-color: var(--status-approved-color); }
.admin-delete-quest-btn, .admin-edit-quest-btn, .admin-view-subs-btn, .admin-edit-challenge-btn, .admin-delete-challenge-btn { width: fit-content; font-size: 12px; padding: 8px 12px; border-radius: 6px; font-weight: 600; cursor: pointer; border: none; color: white; }
.admin-delete-quest-btn, .admin-delete-challenge-btn { background-color: var(--danger-color); }
.admin-edit-quest-btn, .admin-edit-challenge-btn { background-color: var(--action-color); }
.admin-view-subs-btn { background-color: #5856d6; }
.manage-quest-card { display: flex; flex-direction: column; align-items: flex-start; text-align: left; padding: 15px; position: relative; }
.quest-admin-meta { position: static; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; flex-wrap: wrap;}
.quest-status-badge { font-size: 10px; font-weight: 600; padding: 3px 7px; border-radius: 7px; }
.quest-status-badge.status-active { color: var(--status-active-color); background-color: rgba(50, 215, 75, 0.15); }
.quest-status-badge.status-inactive { color: var(--status-inactive-color); background-color: rgba(152, 152, 157, 0.15); }
.manage-quest-info { flex-grow: 1; font-weight: 600; margin-bottom: 10px; width: 100%; }
.admin-buttons-wrapper { display: flex; flex-wrap: wrap; gap: 10px; width: 100%; margin-top: 10px; }
.loader-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 300; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
.spinner { width: 40px; height: 40px; border: 4px solid rgba(255, 255, 255, 0.3); border-top-color: #fff; border-radius: 50%; animation: spin 1s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 200; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
.modal-content { background-color: var(--surface-glass-bg); border: 1px solid var(--divider-glass-color); padding: 20px; border-radius: 14px; width: 90%; max-width: 400px; max-height: 80vh; display: flex; flex-direction: column; }
.modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; gap: 10px; }
.modal-title { font-size: 18px; font-weight: 600; margin: 0; }
.modal-close-btn { background: none; border: none; color: var(--text-color-muted); font-size: 24px; cursor: pointer; }
.modal-body { overflow-y: auto; }
.submission-item { border-bottom: 1px solid var(--divider-glass-color); padding: 10px 0; }
.submission-item:last-child { border-bottom: none; }
.submission-item p { margin: 4px 0; font-size: 14px; }
.submission-status-badge { font-size: 11px; font-weight: 600; padding: 3px 8px; border-radius: 8px; color: white; }
.status-pending { background-color: #ff9500; }
.status-approved { background-color: var(--status-approved-color); }
.category-card { flex-direction: row; justify-content: space-between; align-items: center; }
.category-name { font-weight: 500; flex-grow: 1; margin-right: 10px;}
.category-actions { display: flex; gap: 10px; align-items: center;}
.prompt-modal { background-color: var(--surface-glass-bg); border: 1px solid rgba(58, 58, 60, 0.6); padding: 15px; border-radius: 12px; width: 85%; max-width: 300px; text-align: center; }
.prompt-actions { display:flex; gap: 10px; margin-top: 15px; }
.prompt-actions > * { flex:1; padding: 10px; border: none; border-radius: 8px; font-weight: 600; font-size: 14px; cursor: pointer; }
.prompt-actions .confirm-btn { background-color: var(--primary-color); color: white; }
.prompt-actions .cancel-btn { background-color: #555; color: white; }
.category-actions .sort-btn, .sort-quest-btn { background-color: #555; padding: 4px 8px; font-size: 14px; }
.sort-btn:disabled, .sort-quest-btn:disabled { opacity: 0.3; cursor: not-allowed; }
.quest-category-accordion { width: 100%;}
.quest-category-header { cursor: pointer; font-size: 16px; font-weight: 600; padding: 12px; background-color: rgba(44, 44, 46, 0.85); border-radius: 8px; list-style: none; display: flex; align-items: center; justify-content: space-between; }
.quest-category-header::-webkit-details-marker { display: none; }
.quest-category-header::before { content: '▶'; display: inline-block; margin-right: 8px; font-size: 12px; transition: transform 0.2s; }
.quest-category-accordion[open] > .quest-category-header::before { transform: rotate(90deg); }
.quest-category-body { display: flex; flex-direction: column; gap: 10px; padding: 10px 0 5px; }
.quest-category-header .category-info { flex-grow: 1; display: flex; align-items: center; }
.quest-category-header .category-actions-in-header { display: flex; gap: 10px; align-items: center; }
.sleep-mode-toggle { position: fixed; top: 20px; right: 20px; width: 24px; height: 24px; background-color: var(--action-color); border-radius: 50%; border: none; color: white; font-size: 15px; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.4); z-index: 1000; }
.sleep-mode-toggle.is-sleeping { background-color: var(--danger-color); }
.admin-icon-menu { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 20px; padding: 10px 0; }
.admin-icon-button { display: flex; flex-direction: column; align-items: center; text-align: center; cursor: pointer; text-decoration: none; color: var(--text-color); gap: 8px; }
.admin-icon-button .icon-wrapper { width: 64px; height: 64px; background-color: var(--surface-glass-bg); border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 26px; transition: background-color 0.2s, transform 0.2s; }
.admin-icon-button:active .icon-wrapper { transform: scale(0.95); }
.admin-icon-button span { font-size: 12px; font-weight: 500; line-height: 1.2; }
.admin-icon-button .icon-wrapper .fa-user-check { color: var(--warning-color); }
.admin-icon-button .icon-wrapper .fa-sliders { color: var(--action-color); }
.admin-icon-button .icon-wrapper .fa-user-gear { color: var(--status-approved-color); } 
.pending-action-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;}
.pending-action-type-badge { font-size: 11px; font-weight: 600; padding: 4px 9px; border-radius: 8px; color: white; }
.type-submission { background-color: var(--warning-color); }
.type-prize { background-color: var(--status-approved-color); }
.settings-group { display: flex; flex-direction: column; gap: 15px; margin-top: 20px; }
.settings-group h3 { margin-top: 0; margin-bottom: 5px; font-size: 18px; }
.setting-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--divider-glass-color); }
.setting-item:last-child { border-bottom: none; }
.setting-label { font-size: 15px; font-weight: 500; }
.toggle-switch { position: relative; display: inline-block; width: 51px; height: 31px; }
.toggle-switch input { opacity: 0; width: 0; height: 0; }
.toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #333; transition: .4s; border-radius: 34px; }
.toggle-slider:before { position: absolute; content: ""; height: 23px; width: 23px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
input:checked + .toggle-slider { background-color: var(--primary-color); }
input:checked + .toggle-slider:before { transform: translateX(20px); }
.tabs-container { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 1px solid var(--divider-glass-color); padding-bottom: 10px; }
.tab-button { flex: 1; padding: 10px; font-size: 14px; font-weight: 600; color: var(--text-color-muted); background-color: transparent; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.2s, color 0.2s; display: flex; align-items: center; justify-content: center; gap: 6px; }
.tab-button.active { color: var(--text-color); background-color: var(--surface-glass-bg); }
.tab-content { display: flex; flex-direction: column; gap: 15px; }
.tab-content.hidden { display: none; }
.user-management-section h3 { font-size: 16px; color: var(--primary-color); margin-top: 0; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid var(--divider-glass-color); }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; }
.stat-card { background-color: var(--surface-glass-bg); border-radius: 12px; padding: 15px; text-align: center; position: relative; }
.stat-card-header { display: flex; justify-content: center; align-items: center; gap: 5px; margin: 0 0 10px; }
.stat-card-header h4 { margin: 0; font-size: 14px; color: var(--text-color-muted); font-weight: 500; }
.stat-card p { margin: 0; font-size: 24px; font-weight: 600; color: var(--text-color); }
.event-stat-item { background-color: var(--surface-glass-bg); border-radius: 10px; padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.event-stat-item strong { font-weight: 500; }
.event-stat-item span { font-weight: 600; font-size: 16px; }
.tooltip { position: relative; display: inline-flex; align-items: center; justify-content: center; width: 16px; height: 16px; border-radius: 50%; background-color: #555; color: #fff; cursor: help; font-size: 11px; font-weight: bold; flex-shrink: 0; }
.tooltip .tooltip-text { visibility: hidden; width: 240px; background-color: #222; color: #fff; text-align: left; border-radius: 8px; padding: 10px; position: absolute; z-index: 10; bottom: 125%; left: 50%; transform: translateX(-50%); opacity: 0; transition: opacity 0.3s; font-size: 13px; font-weight: 400; line-height: 1.5; box-shadow: 0 4px 15px rgba(0,0,0,0.5); pointer-events: none; }
.tooltip .tooltip-text::after { content: ""; position: absolute; top: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: #222 transparent transparent transparent; }
.tooltip:hover .tooltip-text { visibility: visible; opacity: 1; }
.stats-grid .stat-card:nth-child(even) .tooltip .tooltip-text { left: auto; right: 0; transform: translateX(0); }
.stats-grid .stat-card:nth-child(even) .tooltip .tooltip-text::after { left: auto; right: 10px; margin-left: 0; }

#twitch-rewards-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 15px;
}
.twitch-reward-card {
    padding: 12px;
}
.twitch-reward-card .quest-title {
    font-size: 15px;
    margin-bottom: 12px;
    text-align: left;
}
.twitch-reward-card .admin-buttons-wrapper {
    margin-top: auto;
    padding-top: 10px;
}
.twitch-reward-card .admin-buttons-wrapper button {
    flex: 1;
    font-size: 13px;
}
.twitch-reward-card .admin-buttons-wrapper .settings-btn {
    background-color: var(--action-color);
}
.twitch-reward-card .admin-buttons-wrapper .purchases-btn {
    background-color: var(--twitch-color);
}

.purchase-item {
    padding: 12px 0;
    border-bottom: 1px solid var(--divider-glass-color);
}
.purchase-item:last-child {
    border-bottom: none;
}
.purchase-item-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}
.purchase-item-header strong {
    font-size: 15px;
}
.purchase-status-badge {
    font-size: 11px;
    font-weight: 600;
    padding: 3px 8px;
    border-radius: 8px;
    color: white;
}
.purchase-status-Привязан { background-color: var(--primary-color); }
.purchase-status-Не.привязан { background-color: var(--status-inactive-color); }

.purchase-item p {
    margin: 4px 0;
    font-size: 13px;
    color: var(--text-color-muted);
}
.purchase-user-input {
    background-color: rgba(0,0,0,0.3);
    padding: 8px;
    border-radius: 6px;
    font-family: monospace;
    font-size: 12px;
    margin-top: 8px;
    word-break: break-all;
}
.purchase-actions {
    margin-top: 12px;
    display: flex;
    gap: 10px;
}
.purchase-actions .issue-promo-btn {
    background-color: var(--warning-color);
    font-size: 13px;
    padding: 8px;
}
.purchase-actions .delete-purchase-btn {
    background-color: var(--danger-color);
    font-size: 13px;
    padding: 8px;
    flex-grow: 0;
    min-width: 40px; /* Чтобы иконка не сжималась */
}
 .purchase-actions .rewarded-info {
    display: flex;
    align-items: center;
    gap: 8px;
    text-align: left;
    font-size: 13px;
    font-weight: 500;
    color: var(--primary-color);
    width: 100%;
}
.purchase-progress {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-color);
    margin-top: 8px !important;
    margin-bottom: 8px !important;
    background-color: rgba(0,0,0,0.2);
    padding: 6px 10px;
    border-radius: 6px;
}
.purchase-progress .progress-good { color: var(--primary-color); }
.purchase-progress .progress-bad { color: var(--warning-color); }
.wizebot-check-wrapper {
    margin-top: 10px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}
.wizebot-check-wrapper .wizebot-check-btn {
    background-color: var(--twitch-color);
    padding: 8px;
    font-size: 13px;
}
.wizebot-result {
    font-size: 13px;
    font-weight: 500;
    text-align: center;
}
/* --- НОВЫЕ СТИЛИ --- */
.purchase-view-status {
    margin: 2px 0 6px;
    font-size: 11px;
    font-weight: 600;
}
.purchase-view-status.status-not-viewed {
    color: var(--text-color-muted);
}
.purchase-view-status.status-viewed {
    color: var(--primary-color);
}
.purchase-win-info {
    font-weight: 600;
    color: var(--text-color);
    background-color: rgba(0,0,0,0.25);
    padding: 8px;
    border-radius: 6px;
    margin-top: 8px;
    margin-bottom: 4px;
    word-break: break-word;
}
.modal-header .admin-action-btn.reject {
    padding: 6px 10px;
    font-size: 12px;
    flex-shrink: 0;
    margin-left: auto;
}
    /* --- НОВЫЕ СТИЛИ ДЛЯ БЛОКИРОВКИ НАГРАД --- */
.purchase-item {
    position: relative; /* Обязательно для позиционирования оверлея */
}
.purchase-item.is-locked .purchase-user-input,
.purchase-item.is-locked .issue-promo-btn {
    filter: blur(4px);
    pointer-events: none;
    opacity: 0.5;
}
.locked-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.6);
    border-radius: 12px; /* Если у родителя есть рамка */
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 10px;
    z-index: 2;
    backdrop-filter: blur(2px);
}
.locked-overlay-text {
    font-size: 14px;
    font-weight: 600;
    color: var(--warning-color);
}
#refresh-purchases-btn {
    background: none;
    border: none;
    color: var(--action-color);
    font-size: 20px;
    cursor: pointer;
    padding: 5px;
    line-height: 1;
}
/* --- КОНЕЦ НОВЫХ СТИЛЕЙ --- */
/* --- Стили для вкладки "Выдача" в ивенте "Котел" --- */
.distribution-header, .distribution-row {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr;
    gap: 10px;
    padding: 10px 5px;
    border-bottom: 1px solid var(--divider-glass-color);
    align-items: center;
    font-size: 14px;
}

.distribution-header {
    font-weight: 600;
    color: var(--text-color-muted);
}

.distribution-row .dist-name {
    font-weight: 500;
    word-break: break-word;
}

.distribution-row .dist-amount {
    text-align: center;
    font-weight: 600;
}

.distribution-row .dist-link {
    text-align: right;
}

.distribution-row .dist-link a {
    color: var(--action-color);
    text-decoration: none;
    font-weight: 500;
}

.distribution-row .dist-link .no-link {
    color: var(--danger-color);
    font-style: italic;
    opacity: 0.8;
}
/* --- ИСПРАВЛЕНИЕ ДЛЯ ПРОКРУТКИ В ИВЕНТЕ "КОТЕЛ" --- */
#cauldron-distribution-list {
  overflow-x: auto;
}
